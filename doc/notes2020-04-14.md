# Wed Apr 14 22:54:28 2021 ------------------------------

1. To create data base:

    $ mysql -u root -p
    [password or just enter if one isn't set]
    MariaDB [r]> CREATE DATABASE r;
    CREATE TABLE jgr (
    recid INT AUTO_INCREMENT PRIMARY KEY,
    id INT,
    v1 FLOAT,
    v2 FLOAT,
    v3 FLOAT,
    v4 FLOAT,
    v5 FLOAT,
    v6 FLOAT,
    v7 FLOAT,
    v8 FLOAT,
    v9 FLOAT,
    v10 FLOAT,
    v11 FLOAT,
    v12 FLOAT,
    v13 FLOAT,
    v14 FLOAT,
    v15 FLOAT,
    v16 FLOAT,
    v17 FLOAT,
    v18 FLOAT,
    v19 FLOAT,
    v20 FLOAT,
    v21 FLOAT,
    v22 FLOAT,
    v23 FLOAT,
    v24 FLOAT)
    ;
    CREATE USER 'studio'@'localhost' IDENTIFIED BY 'studio';
    GRANT ALL PRIVILEGES ON r.jgr TO 'studio'@'localhost';
    quit;

To start over

    drop table jgr;

and repeat from top


2. Preparation of *.txt files can be done in shell

# remove false headers
# take file name as the identifier
# cross map varnames; should just leave holes?


# insert identifier as first column

  awk -F, '{$1= FILENAME FS $1;}1' OFS=, part1.tsv

# now need to substitute first subsitution with "id"

# assumes always three false header lines; otherwise need to delete down to first line beginning with V1, which is doable with sed




todo: extract the filename without the extension
  
Here's how it would be done given the processed file

    $ mysql -u studio -p
    [password]
    MariaDB [r]>
    
    LOAD DATA LOCAL INFILE 'home/roc/projects/jgr/obj/part1.tsv'
    INTO TABLE jgr;
    FIELDS TERMINATED BY ',';
    LINES TERMINATED BY '\n';
    
For only 70 input files, I'd be inclined to simply spit out the three lines from the list of tsv file names using a script and cut and paste into the MariaDB setting, since it's a one-time operation

mysqlimport loads tables from text files in various formats. The base name of the text file must be the name of the table that should be used. 

mysqlimport fields-terminated-by ',' lines terminated by '\n' r jgr


#!/bin/bash
#loop to iterate through each file in current directory and rename
ext = ".txt"
for file in ???
do
  basename $file .txt
  
  awk -F, '{$1 = FILENAME FS $1;}1' OFS = , jgr   | 
    sed 1,3d  | 
    sed 1,1s/"part1.tsv"/"id"/ | 
    sed s/".tsv"// | 
    sed 's/\t/,/g' | 
    sed 1,1s/"V"/"v"/g 
    
| 
    mysqlimport fields-terminated-by ',' lines terminated by '\n' r jgr #
    mv jgr basename$ext # ?
done


  mv basename $1 .txt jgr


  mv basename $file .txt jgr




